filter(!str_detect(Step, "CW")) %>%
mutate(Step = fct_drop(Step))
data_flash %<>%
dplyr::select(!Chan) %>%
pivot_wider(names_from="Marker", values_from=c("Amp", "Time")) %>%
mutate('Amp_ab' = Amp_b - Amp_a) %>%
pivot_longer(cols=starts_with(c('Amp_','Time_'))) %>%
pivot_wider(names_from="name", values_from="value")
data_flicker <- data %>%
filter(str_detect(Step, "Flicker")) %>%
mutate(Step = fct_drop(Step)) %>%
dplyr::select(!Time) %>% # drop time values
pivot_wider(names_from="Marker", values_from="Amp") %>%
mutate(Amp_1 = Peak1 - Trough1,
Amp_2 = Peak2 - Trough2,
Amp_3 = Peak3 - Trough3,
Amp_4 = Peak4 - Trough4,
Amp_5 = Peak5 - Trough5)
data_flicker <- mutate(data_flicker, Amp = rowMeans(dplyr::select(data_flicker, starts_with("Amp_"))))%>%
dplyr::select(Subject, Group, Timepoint, Step, Eye, Amp)
data %>%
dplyr::select(Subject, Group, Timepoint) %>%
unique() %>%
group_by(Group, Subject) %>%
summarise(count=n())
data_flash %>%
filter(Step %in% c('DA 0.001 cd.s/m2 + OP', 'DA 3 cd.s/m2 + OP', 'LA 3 cd.s/m2 + OP')) %>%
ggplot(aes(x=Timepoint, y=Amp_ab, color=Group)) +
geom_boxplot() +
facet_grid(rows=vars(Step), cols=vars(Eye), scales="free_y")
data_flash %>%
filter(Step %in% c('DA 0.01 cd.s/m2 + OP', 'DA 3 cd.s/m2 + OP', 'LA 3 cd.s/m2 + OP')) %>%
ggplot(aes(x=Timepoint, y=Amp_ab, color=Group)) +
geom_boxplot() +
facet_grid(rows=vars(Step), cols=vars(Eye), scales="free_y")
model <- data_flash %>%
filter(Step == 'DA 0.01 cd.s/m2 + OP') %>%
lm(Amp_ab ~ I(Subject) + Group * days - 1, data=.)
anova(model)
summary(model)
model <- data_flash %>%
filter(Step == 'DA 0.01 cd.s/m2 + OP') %>%
filter(Timepoint == "Day 30") %>%
lm(Amp_ab ~ I(Subject) + Group, data=.)
anova(model)
summary(model)
model <- data_flash %>%
filter(Step == 'DA 0.01 cd.s/m2 + OP') %>%
filter(Timepoint == "Day 22") %>%
lm(Amp_ab ~ I(Subject) + Group, data=.)
anova(model)
summary(model)
data_flash %>%
filter(Step == 'DA 0.01 cd.s/m2 + OP') %>%
ggplot(aes(x=days, y=Amp_ab, color=Group, group=Group)) +
geom_point() +
stat_smooth(method=lm, se=TRUE) +
ggtitle('DA 0.01 Smooth=Linear')
data_flash %>%
filter(Step == 'DA 0.01 cd.s/m2 + OP') %>%
ggplot(aes(x=days, y=Amp_ab, color=Group, group=Group)) +
geom_point() +
stat_smooth(method=loess, se=TRUE) +
ggtitle('DA 0.01 Smooth=Loess')
data_flash %>%
filter(Step == 'DA 0.01 cd.s/m2 + OP') %>%
ggplot(aes(x=Timepoint, y=Amp_ab, fill=Group)) +
stat_summary(fun="mean", geom="bar", position = position_dodge(0.95)) +
stat_summary(fun='mean', geom='point', position = position_dodge(0.95), size=1) +
stat_summary(fun.data = "mean_cl_normal", geom="errorbar", position = position_dodge(0.95), width=0.2)
model <- data_flash %>%
filter(Step == 'DA 0.01 cd.s/m2 + OP') %>%
filter(Timepoint == "Day 15") %>%
lm(Amp_ab ~ I(Subject) + Group, data=.)
model <- data_flash %>%
filter(Step == 'DA 0.01 cd.s/m2 + OP') %>%
filter(Timepoint == "Day 15") %>%
lm(Amp_ab ~ I(Subject) + Group, data=.)
anova(model)
summary(model)
data_flash %>%
filter(Step == 'DA 0.01 cd.s/m2 + OP') %>%
ggplot(aes(x=days, y=Amp_b, color=Group, group=Group)) +
geom_point() +
stat_smooth(method=lm, se=TRUE) +
ggtitle('DA 0.01 Smooth=Linear')
data <- read.csv('data/markers.csv')
data <- data %>%
mutate(Step = factor(Step, levels = c('DA 0.001 cd.s/m2 + OP',
'DA 0.003 cd.s/m2 + OP',
'DA 0.01 cd.s/m2 + OP',
'DA 0.03 cd.s/m2 + OP',
'DA 0.1 cd.s/m2 + OP',
'DA 0.3 cd.s/m2 + OP',
'DA 1 cd.s/m2 + OP',
'DA 3 cd.s/m2 + OP',
'DA 10 cd.s/m2 + OP',
'CW 150 cd/m2',
'LA 0.03 cd.s/m2 + OP',
'LA 0.3 cd.s/m2 + OP',
'LA 3 cd.s/m2 + OP',
'LA 3 cd.s/m2 10 Hz Flicker',
'LA 3 cd.s/m2 20 Hz Flicker',
'LA 3 cd.s/m2 30 Hz Flicker',
'LA 3 cd.s/m2 40 Hz Flicker'))) %>%
mutate(Timepoint = factor(Timepoint, levels = c('Baseline',
'Day 8',
'Day 15',
'Day 22',
'Day 30',
'Day 38'))) %>%
mutate(days = as.numeric(ifelse(Timepoint=="Baseline", 0, str_extract(Timepoint, "\\d+"))))
data_flash <- data %>%
filter(!str_detect(Step, "Flicker")) %>%
filter(!str_detect(Step, "CW")) %>%
mutate(Step = fct_drop(Step))
data_flash %<>%
dplyr::select(!Chan) %>%
pivot_wider(names_from="Marker", values_from=c("Amp", "Time")) %>%
mutate('Amp_ab' = Amp_b - Amp_a) %>%
pivot_longer(cols=starts_with(c('Amp_','Time_'))) %>%
pivot_wider(names_from="name", values_from="value")
data_flicker <- data %>%
filter(str_detect(Step, "Flicker")) %>%
mutate(Step = fct_drop(Step)) %>%
dplyr::select(!Time) %>% # drop time values
pivot_wider(names_from="Marker", values_from="Amp") %>%
mutate(Amp_1 = Peak1 - Trough1,
Amp_2 = Peak2 - Trough2,
Amp_3 = Peak3 - Trough3,
Amp_4 = Peak4 - Trough4,
Amp_5 = Peak5 - Trough5) %>%
mutate(Amp = mean(Amp_1, Amp_2, Amp_3, Amp_4, Amp_5, na.rm=TRUE))
data <- read.csv('data/markers.csv')
data <- data %>%
mutate(Step = factor(Step, levels = c('DA 0.001 cd.s/m2 + OP',
'DA 0.003 cd.s/m2 + OP',
'DA 0.01 cd.s/m2 + OP',
'DA 0.03 cd.s/m2 + OP',
'DA 0.1 cd.s/m2 + OP',
'DA 0.3 cd.s/m2 + OP',
'DA 1 cd.s/m2 + OP',
'DA 3 cd.s/m2 + OP',
'DA 10 cd.s/m2 + OP',
'CW 150 cd/m2',
'LA 0.03 cd.s/m2 + OP',
'LA 0.3 cd.s/m2 + OP',
'LA 3 cd.s/m2 + OP',
'LA 3 cd.s/m2 10 Hz Flicker',
'LA 3 cd.s/m2 20 Hz Flicker',
'LA 3 cd.s/m2 30 Hz Flicker',
'LA 3 cd.s/m2 40 Hz Flicker'))) %>%
mutate(Timepoint = factor(Timepoint, levels = c('Baseline',
'Day 8',
'Day 15',
'Day 22',
'Day 30',
'Day 38'))) %>%
mutate(days = as.numeric(ifelse(Timepoint=="Baseline", 0, str_extract(Timepoint, "\\d+"))))
data_flash <- data %>%
filter(!str_detect(Step, "Flicker")) %>%
filter(!str_detect(Step, "CW")) %>%
mutate(Step = fct_drop(Step))
data_flash %<>%
dplyr::select(!Chan) %>%
pivot_wider(names_from="Marker", values_from=c("Amp", "Time")) %>%
mutate('Amp_ab' = Amp_b - Amp_a) %>%
pivot_longer(cols=starts_with(c('Amp_','Time_'))) %>%
pivot_wider(names_from="name", values_from="value")
data_flicker <- data %>%
filter(str_detect(Step, "Flicker")) %>%
mutate(Step = fct_drop(Step)) %>%
dplyr::select(!Time) %>% # drop time values
pivot_wider(names_from="Marker", values_from="Amp") %>%
mutate(Amp_1 = Peak1 - Trough1,
Amp_2 = Peak2 - Trough2,
Amp_3 = Peak3 - Trough3,
Amp_4 = Peak4 - Trough4,
Amp_5 = Peak5 - Trough5)
data_flicker <- mutate(data_flicker, Amp = rowMeans(dplyr::select(data_flicker, starts_with("Amp_"))))%>%
dplyr::select(Subject, Group, Timepoint, Step, Eye, Amp)
data %>%
dplyr::select(Subject, Group, Timepoint) %>%
unique() %>%
group_by(Group, Subject) %>%
summarise(count=n())
head(data_flicker)
data <- read.csv('data/markers.csv')
data <- data %>%
mutate(Step = factor(Step, levels = c('DA 0.001 cd.s/m2 + OP',
'DA 0.003 cd.s/m2 + OP',
'DA 0.01 cd.s/m2 + OP',
'DA 0.03 cd.s/m2 + OP',
'DA 0.1 cd.s/m2 + OP',
'DA 0.3 cd.s/m2 + OP',
'DA 1 cd.s/m2 + OP',
'DA 3 cd.s/m2 + OP',
'DA 10 cd.s/m2 + OP',
'CW 150 cd/m2',
'LA 0.03 cd.s/m2 + OP',
'LA 0.3 cd.s/m2 + OP',
'LA 3 cd.s/m2 + OP',
'LA 3 cd.s/m2 10 Hz Flicker',
'LA 3 cd.s/m2 20 Hz Flicker',
'LA 3 cd.s/m2 30 Hz Flicker',
'LA 3 cd.s/m2 40 Hz Flicker'))) %>%
mutate(Timepoint = factor(Timepoint, levels = c('Baseline',
'Day 8',
'Day 15',
'Day 22',
'Day 30',
'Day 38'))) %>%
mutate(days = as.numeric(ifelse(Timepoint=="Baseline", 0, str_extract(Timepoint, "\\d+"))))
data_flash <- data %>%
filter(!str_detect(Step, "Flicker")) %>%
filter(!str_detect(Step, "CW")) %>%
mutate(Step = fct_drop(Step))
data_flash %<>%
dplyr::select(!Chan) %>%
pivot_wider(names_from="Marker", values_from=c("Amp", "Time")) %>%
mutate('Amp_ab' = Amp_b - Amp_a) %>%
pivot_longer(cols=starts_with(c('Amp_','Time_'))) %>%
pivot_wider(names_from="name", values_from="value")
data_flicker <- data %>%
filter(str_detect(Step, "Flicker")) %>%
mutate(Step = fct_drop(Step)) %>%
dplyr::select(!Time) %>% # drop time values
pivot_wider(names_from="Marker", values_from="Amp") %>%
mutate(Amp_1 = Peak1 - Trough1,
Amp_2 = Peak2 - Trough2,
Amp_3 = Peak3 - Trough3,
Amp_4 = Peak4 - Trough4,
Amp_5 = Peak5 - Trough5)
data_flicker <- mutate(data_flicker, Amp = rowMeans(dplyr::select(data_flicker, starts_with("Amp_"))))%>%
dplyr::select(Subject, Group, Timepoint, Step, Eye, Amp, Days)
data <- read.csv('data/markers.csv')
data <- data %>%
mutate(Step = factor(Step, levels = c('DA 0.001 cd.s/m2 + OP',
'DA 0.003 cd.s/m2 + OP',
'DA 0.01 cd.s/m2 + OP',
'DA 0.03 cd.s/m2 + OP',
'DA 0.1 cd.s/m2 + OP',
'DA 0.3 cd.s/m2 + OP',
'DA 1 cd.s/m2 + OP',
'DA 3 cd.s/m2 + OP',
'DA 10 cd.s/m2 + OP',
'CW 150 cd/m2',
'LA 0.03 cd.s/m2 + OP',
'LA 0.3 cd.s/m2 + OP',
'LA 3 cd.s/m2 + OP',
'LA 3 cd.s/m2 10 Hz Flicker',
'LA 3 cd.s/m2 20 Hz Flicker',
'LA 3 cd.s/m2 30 Hz Flicker',
'LA 3 cd.s/m2 40 Hz Flicker'))) %>%
mutate(Timepoint = factor(Timepoint, levels = c('Baseline',
'Day 8',
'Day 15',
'Day 22',
'Day 30',
'Day 38'))) %>%
mutate(days = as.numeric(ifelse(Timepoint=="Baseline", 0, str_extract(Timepoint, "\\d+"))))
data_flash <- data %>%
filter(!str_detect(Step, "Flicker")) %>%
filter(!str_detect(Step, "CW")) %>%
mutate(Step = fct_drop(Step))
data_flash %<>%
dplyr::select(!Chan) %>%
pivot_wider(names_from="Marker", values_from=c("Amp", "Time")) %>%
mutate('Amp_ab' = Amp_b - Amp_a) %>%
pivot_longer(cols=starts_with(c('Amp_','Time_'))) %>%
pivot_wider(names_from="name", values_from="value")
data_flicker <- data %>%
filter(str_detect(Step, "Flicker")) %>%
mutate(Step = fct_drop(Step)) %>%
dplyr::select(!Time) %>% # drop time values
pivot_wider(names_from="Marker", values_from="Amp") %>%
mutate(Amp_1 = Peak1 - Trough1,
Amp_2 = Peak2 - Trough2,
Amp_3 = Peak3 - Trough3,
Amp_4 = Peak4 - Trough4,
Amp_5 = Peak5 - Trough5)
data_flicker <- mutate(data_flicker, Amp = rowMeans(dplyr::select(data_flicker, starts_with("Amp_"))))%>%
dplyr::select(Subject, Group, Timepoint, Step, Eye, Amp, days)
data %>%
dplyr::select(Subject, Group, Timepoint) %>%
unique() %>%
group_by(Group, Subject) %>%
summarise(count=n())
data_flicker %>% head()
data_flash %>%
filter(Step == 'LA 3 cd.s/m2 10 Hz Flicker') %>%
ggplot(aes(x=days, y=Amp_ab, color=Group, group=Group)) +
geom_point() +
stat_smooth(method=lm, se=TRUE) +
ggtitle('LA 3 Smooth=Linear')
data_flash %>%
filter(Step == 'LA 3 cd.s/m2 10 Hz Flicker') %>%
ggplot(aes(x=days, y=Amp, color=Group, group=Group)) +
geom_point() +
stat_smooth(method=lm, se=TRUE) +
ggtitle('LA 3 Smooth=Linear')
data_flicker %>%
filter(Step == 'LA 3 cd.s/m2 10 Hz Flicker') %>%
ggplot(aes(x=days, y=Amp, color=Group, group=Group)) +
geom_point() +
stat_smooth(method=lm, se=TRUE) +
ggtitle('LA 3 Smooth=Linear')
model <- data_flicker %>%
filter(Step == 'LA 3 cd.s/m2 + OP') %>%
lm(Amp_ab ~ I(Subject) + Group * days -1, data=.)
model <- data_flicker %>%
filter(Step == 'LA 3 cd.s/m2 + OP') %>%
lm(Amp ~ I(Subject) + Group * days -1, data=.)
head(data_flicker)
data_flicker$Group
data_flicker$Timepoint
data <- read.csv('data/markers.csv')
data <- data %>%
mutate(Step = factor(Step, levels = c('DA 0.001 cd.s/m2 + OP',
'DA 0.003 cd.s/m2 + OP',
'DA 0.01 cd.s/m2 + OP',
'DA 0.03 cd.s/m2 + OP',
'DA 0.1 cd.s/m2 + OP',
'DA 0.3 cd.s/m2 + OP',
'DA 1 cd.s/m2 + OP',
'DA 3 cd.s/m2 + OP',
'DA 10 cd.s/m2 + OP',
'CW 150 cd/m2',
'LA 0.03 cd.s/m2 + OP',
'LA 0.3 cd.s/m2 + OP',
'LA 3 cd.s/m2 + OP',
'LA 3 cd.s/m2 10 Hz Flicker',
'LA 3 cd.s/m2 20 Hz Flicker',
'LA 3 cd.s/m2 30 Hz Flicker',
'LA 3 cd.s/m2 40 Hz Flicker'))) %>%
mutate(Timepoint = factor(Timepoint, levels = c('Baseline',
'Day 8',
'Day 15',
'Day 22',
'Day 30',
'Day 38'))) %>%
mutate(days = as.numeric(ifelse(Timepoint=="Baseline", 0, str_extract(Timepoint, "\\d+"))))
data_flash <- data %>%
filter(!str_detect(Step, "Flicker")) %>%
filter(!str_detect(Step, "CW")) %>%
mutate(Step = fct_drop(Step))
data_flash %<>%
dplyr::select(!Chan) %>%
pivot_wider(names_from="Marker", values_from=c("Amp", "Time")) %>%
mutate('Amp_ab' = Amp_b - Amp_a) %>%
pivot_longer(cols=starts_with(c('Amp_','Time_'))) %>%
pivot_wider(names_from="name", values_from="value")
data_flicker <- data %>%
filter(str_detect(Step, "Flicker")) %>%
mutate(Step = fct_drop(Step)) %>%
dplyr::select(!Time) %>% # drop time values
pivot_wider(names_from="Marker", values_from="Amp") %>%
mutate(Amp_1 = Peak1 - Trough1,
Amp_2 = Peak2 - Trough2,
Amp_3 = Peak3 - Trough3,
Amp_4 = Peak4 - Trough4,
Amp_5 = Peak5 - Trough5)
data_flicker <- mutate(data_flicker, Amp = rowMeans(dplyr::select(data_flicker, starts_with("Amp_"))))%>%
dplyr::select(Subject, Group, Timepoint, Step, Eye, Amp, days) %>%
mutate(Subject = factor(Subject),
Group = factor(Group))
data %>%
dplyr::select(Subject, Group, Timepoint) %>%
unique() %>%
group_by(Group, Subject) %>%
summarise(count=n())
model <- data_flicker %>%
filter(Step == 'LA 3 cd.s/m2 + OP') %>%
lm(Amp ~ I(Subject) + Group * days -1, data=.)
data_flicker %>%
filter(Step == 'LA 3 cd.s/m2 10 Hz Flicker') %>%
ggplot(aes(x=days, y=Amp, color=Group, group=Group)) +
geom_point() +
stat_smooth(method=lm, se=TRUE) +
ggtitle('LA 3 Smooth=Linear')
str(data_flicker)
model <- data_flicker %>%
filter(Step == 'LA 3 cd.s/m2 10 Hz Flicker') %>%
lm(Amp ~ I(Subject) + Group * days -1, data=.)
anova(model)
summary(model)
data_flicker %>%
filter(Step == 'LA 3 cd.s/m2 10 Hz Flicker') %>%
ggplot(aes(x=days, y=Amp, color=Group, group=Group)) +
geom_point() +
stat_smooth(method=lm, se=TRUE) +
ggtitle('LA Flicker 10Hz Smooth=Linear')
data_flicker %>%
filter(Step == 'LA 3 cd.s/m2 10 Hz Flicker') %>%
ggplot(aes(x=days, y=Amp, color=Group, group=Group)) +
geom_point() +
stat_smooth(method=lm, se=TRUE) +
ggtitle('LA Flicker 10Hz. Smooth=Linear')
data_flicker %>%
filter(Step == 'LA 3 cd.s/m2 20 Hz Flicker') %>%
ggplot(aes(x=days, y=Amp, color=Group, group=Group)) +
geom_point() +
stat_smooth(method=lm, se=TRUE) +
ggtitle('LA Flicker 20Hz. Smooth=Linear')
model <- data_flicker %>%
filter(Step == 'LA 3 cd.s/m2 20 Hz Flicker') %>%
lm(Amp ~ I(Subject) + Group * days -1, data=.)
anova(model)
summary(model)
data_flicker %>%
filter(Step == 'LA 3 cd.s/m2 30 Hz Flicker') %>%
ggplot(aes(x=days, y=Amp, color=Group, group=Group)) +
geom_point() +
stat_smooth(method=lm, se=TRUE) +
ggtitle('LA Flicker 30Hz. Smooth=Linear')
model <- data_flicker %>%
filter(Step == 'LA 3 cd.s/m2 30 Hz Flicker') %>%
lm(Amp ~ I(Subject) + Group * days -1, data=.)
anova(model)
summary(model)
data_flicker %>%
filter(Step == 'LA 3 cd.s/m2 40 Hz Flicker') %>%
ggplot(aes(x=days, y=Amp, color=Group, group=Group)) +
geom_point() +
stat_smooth(method=lm, se=TRUE) +
ggtitle('LA Flicker 40Hz. Smooth=Linear')
model <- data_flicker %>%
filter(Step == 'LA 3 cd.s/m2 40 Hz Flicker') %>%
lm(Amp ~ I(Subject) + Group * days -1, data=.)
anova(model)
summary(model)
t <- data_flash %>%
mutate(Intensity = as.numeric(str_extract(Step, "\\d+\\.*\\d*")))
m1 <- t %>%
filter(Condition=='DA' & Timepoint=='Baseline') %>%
group_by(Subject, Eye) %>%
do(data.frame(setNames(as.list(coef(drm(Amp_ab~Intensity, data=., fct=MM.2(), lowerl=c(0,0), upperl=c(500,1) ))),
c('Vmax','K'))))
m1
str(data_flash)
m1 <- t %>%
filter(Condition=='DA' & Timepoint=='Baseline') %>%
group_by(Subject) %>%
do(data.frame(setNames(as.list(coef(drm(Amp_ab~Intensity, data=., fct=MM.2(), lowerl=c(0,0), upperl=c(500,1) ))),
c('Vmax','K'))))
m1
plot(m1)
plot(m1, broken=TRUE)
t <- data_flash %>%
mutate(Intensity = as.numeric(str_extract(Step, "\\d+\\.*\\d*")))
m1 <- t %>%
filter(Condition=='DA' & Timepoint=='Baseline') %>%
group_by(Subject) %>%
do(data.frame(setNames(as.list(coef(drm(Amp_ab~Intensity, data=., fct=MM.2(), lowerl=c(0,0), upperl=c(500,1) ))),
c('Vmax','K'))))
t %>%
filter(Condition=='DA' & Timepoint=='Baseline') %>%
filter(Subject == 13075) %>%
ggplot(aes(x=Intensity, y = Amp_ab)) +
geom_point()
warnings()
t %>%
filter(Condition=='DA' & Timepoint=='Baseline') %>%
filter(Subject == 13075) %>%
ggplot(aes(x=Intensity, y = Amp_ab)) +
geom_point()
head(t)
t <- data_flash %>%
mutate(Intensity = as.numeric(str_extract(Step, "\\d+\\.*\\d*")))
m1 <- t %>%
filter(Condition=='DA' & Timepoint=='Baseline') %>%
group_by(Subject) %>%
do(data.frame(setNames(as.list(coef(drm(Amp_ab~Intensity, data=., fct=MM.2(), lowerl=c(0,0), upperl=c(500,1) ))),
c('Vmax','K'))))
t %>%
filter(Condition=='DA' & Timepoint=='Baseline') %>%
filter(Subject == 13075) %>%
ggplot(aes(x=Intensity, y = Amp_ab)) +
scale_x_continuous(trans='log10') +
geom_point()
plot(m1, col=TRUE)
m<-t %>%
filter(Condition=='DA' & Timepoint=='Baseline') %>%
filter(Subject == 13075) %>%
drm(Amp_ab~Intensity, data=., fct=MM.2(),lowerl=c(0,0), upperl=c(500,1))
plot(m)
m<-t %>%
filter(Condition=='DA' & Timepoint=='Baseline') %>%
drm(Amp_ab~Intensity, data=., Subject, fct=MM.2(),lowerl=c(0,0), upperl=c(500,1))
plot(m, col=TRUE)
plot(m, col=TRUE, lwd=2)
m<-t %>%
filter(Condition=='DA' & Timepoint=='Day 8') %>%
drm(Amp_ab~Intensity, data=., Subject, fct=MM.2(),lowerl=c(0,0), upperl=c(500,1))
t <- data_flash %>%
mutate(Intensity = as.numeric(str_extract(Step, "\\d+\\.*\\d*")))
m<-t %>%
filter(Condition=='DA' & Timepoint=='Baseline') %>%
drm(Amp_ab~Intensity, data=., Subject, fct=MM.2(),lowerl=c(0,0), upperl=c(500,1))
plot(m, col=TRUE, lwd=1)
plot(m, col=TRUE, lwd=1)
plot(m, col=TRUE, lwd=1)
?MM.2
library(tidyverse)
library(magrittr)
library(ggplot2)
library(forcats)
library(stringr)
library(drc)
m2<-t %>%
filter(Condition=='DA' & Timepoint=='Day 8') %>%
drm(Amp_b~Intensity, data=., Subject, fct=MM.2(),lowerl=c(0,0), upperl=c(500,1))
